<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<title>Muz D√ºnyasƒ± üçå</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  body, html {
    margin: 0; padding: 0; height: 100%; overflow: hidden;
    background: #000;
    font-family: 'Press Start 2P', cursive;
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }
  #gameCanvas {
    display: block;
    margin: auto;
    background: #87CEEB; /* G√∂ky√ºz√º a√ßƒ±k */
    image-rendering: pixelated;
    touch-action: manipulation;
    border: 4px solid black;
  }
  #overlay {
    position: fixed;
    top:0; left:0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.85);
    color: #fff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 18px;
    text-align: center;
    user-select: none;
    z-index: 10;
    font-family: 'Press Start 2P', cursive;
  }
  #overlay.hidden {
    display: none;
  }
  #replayBtn {
    margin-top: 20px;
    background: #fff;
    color: #000;
    border: none;
    padding: 12px 24px;
    cursor: pointer;
    font-family: 'Press Start 2P', cursive;
    font-size: 14px;
    border-radius: 5px;
  }
</style>
</head>
<body>

<canvas id="gameCanvas" width="400" height="600"></canvas>

<div id="overlay" class="hidden">
  <div id="endingText"></div>
  <button id="replayBtn">TEKRAR OYNA</button>
</div>

<!-- Ses efektleri -->
<audio id="eatSound" src="https://freesound.org/data/previews/341/341695_3248244-lq.mp3" preload="auto"></audio>
<audio id="fartSound" src="https://www.soundjay.com/human/fart-01.mp3" preload="auto"></audio>

<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const overlay = document.getElementById('overlay');
  const endingText = document.getElementById('endingText');
  const replayBtn = document.getElementById('replayBtn');
  const eatSound = document.getElementById('eatSound');
  const fartSound = document.getElementById('fartSound');

  const WIDTH = canvas.width;
  const HEIGHT = canvas.height;

  // Oyun durumu: 'playing', 'goodEnd', 'badEnd'
  let gameState = 'playing';

  // Adamƒ±n pozisyonu ve boyutu
  const player = {
    x: 170,
    y: 400,
    w: 60,
    h: 80,
  };

  // Muz pozisyonu ve boyutu (adamƒ±n elinde)
  const banana = {
    x: player.x + 20,
    y: player.y + 40,
    w: 20,
    h: 30,
    eaten: false,
  };

  // Piksel piksel adam √ßiz (basit ≈üekillerle)
  function drawPlayer() {
    // Sa√ß (sarƒ±)
    ctx.fillStyle = '#FFD700';
    ctx.fillRect(player.x + 15, player.y, 30, 15);

    // Kafa (ten rengi)
    ctx.fillStyle = '#F1C27D';
    ctx.fillRect(player.x + 20, player.y + 15, 20, 20);

    // G√∂zler (siyah)
    ctx.fillStyle = '#000';
    ctx.fillRect(player.x + 23, player.y + 22, 5, 5);
    ctx.fillRect(player.x + 32, player.y + 22, 5, 5);

    // G√∂vde (siyah ti≈ü√∂rt)
    ctx.fillStyle = '#000000';
    ctx.fillRect(player.x + 10, player.y + 35, 40, 40);

    // Pantolon (kahverengi)
    ctx.fillStyle = '#8B4513';
    ctx.fillRect(player.x + 10, player.y + 75, 40, 25);

    // Ayakkabƒ± (siyah)
    ctx.fillStyle = '#000';
    ctx.fillRect(player.x + 10, player.y + 100, 18, 10);
    ctx.fillRect(player.x + 32, player.y + 100, 18, 10);

    // Muz (sarƒ±, eƒüer yenmediyse)
    if (!banana.eaten) {
      ctx.fillStyle = '#FFFF00';
      ctx.fillRect(banana.x, banana.y, banana.w, banana.h);
      // Muz sapƒ± kahverengi
      ctx.fillStyle = '#8B4513';
      ctx.fillRect(banana.x + 5, banana.y, 10, 5);
    }
  }

  // Muz yerken yeme animasyonu (muz k√º√ß√ºk birden kaybolacak)
  function eatBananaAnim() {
    if (banana.w > 0) {
      banana.w -= 1;
      banana.h -= 1.5;
      banana.x += 0.5;
      banana.y += 1;
    } else {
      banana.eaten = true;
    }
  }

  // Piksel tarzda d√ºnya √ßizimi (uzaydan g√∂r√ºn√ºm)
  function drawPixelWorld(good) {
    const size = 15; // Her blok 15x15 piksel
    for(let y=0; y < HEIGHT; y += size) {
      for(let x=0; x < WIDTH; x += size) {
        let color;
        if(good) {
          // ƒ∞yi son - mavi ve ye≈üil karƒ±≈üƒ±mƒ± (uzaydan d√ºnya)
          color = (Math.random() < 0.2) ? '#225522' : '#224488';
        } else {
          // K√∂t√º son - muz sarƒ±sƒ± ve kahverengi tonlarƒ±
          color = (Math.random() < 0.3) ? '#FFEB3B' : '#8B4513';
        }
        ctx.fillStyle = color;
        ctx.fillRect(x, y, size, size);
      }
    }
  }

  // Yazƒ±larƒ± piksel fontla ortala
  function drawCenteredText(text, y) {
    ctx.fillStyle = '#fff';
    ctx.font = "16px 'Press Start 2P'";
    const textWidth = ctx.measureText(text).width;
    ctx.fillText(text, (WIDTH - textWidth) / 2, y);
  }

  // Pƒ±rt animasyonu (k√º√ß√ºk sarƒ± bulut)
  let fartEffect = { active: false, x: 0, y: 0, size: 20, alpha: 1 };

  function drawFart() {
    if (!fartEffect.active) return;
    ctx.save();
    ctx.globalAlpha = fartEffect.alpha;
    ctx.fillStyle = '#FFD700';
    ctx.beginPath();
    ctx.ellipse(fartEffect.x, fartEffect.y, fartEffect.size, fartEffect.size * 0.6, 0, 0, 2 * Math.PI);
    ctx.fill();
    ctx.restore();

    // Fart efekti k√º√ß√ºl√ºp saydamla≈üƒ±r
    fartEffect.size += 0.5;
    fartEffect.alpha -= 0.02;
    if (fartEffect.alpha <= 0) fartEffect.active = false;
  }

  // Oyun d√∂ng√ºs√º ve √ßizim
  let eatAnimPlaying = false;
  let eatAnimFrame = 0;
  let eatSoundPlayed = false;
  let fartSoundPlayed = false;

  function gameLoop() {
    ctx.clearRect(0, 0, WIDTH, HEIGHT);

    if (gameState === 'playing') {
      // G√∂ky√ºz√º a√ßƒ±k mavi
      ctx.fillStyle = '#87CEEB';
      ctx.fillRect(0, 0, WIDTH, HEIGHT);

      // √áimen alanƒ± (alt kƒ±sƒ±m)
      ctx.fillStyle = '#228B22';
      ctx.fillRect(0, player.y + player.h, WIDTH, HEIGHT - (player.y + player.h));

      drawPlayer();

      // Muz yeme animasyonu
      if (eatAnimPlaying) {
        if (!eatSoundPlayed) {
          eatSound.play();
          eatSoundPlayed = true;
        }
        eatBananaAnim();
        if (banana.eaten) {
          eatAnimPlaying = false;
          fartEffect.active = true;
          fartEffect.x = player.x + player.w / 2;
          fartEffect.y = player.y + player.h - 10;
          if (!fartSoundPlayed) {
            fartSound.play();
            fartSoundPlayed = true;
          }
        }
      }

      drawFart();

      if (!banana.eaten && !eatAnimPlaying) {
        drawCenteredText("Muz yiyor...", 100);
      }

      if (fartEffect.active) {
        drawCenteredText("üí® Pƒ±rt!", 130);
      }

    } else if (gameState === 'goodEnd') {
      drawPixelWorld(true);
      drawCenteredText("ƒ∞Yƒ∞ SON", HEIGHT/2);
    } else if (gameState === 'badEnd') {
      drawPixelWorld(false);
      drawCenteredText("K√ñT√ú SON", HEIGHT/2);
    }

    requestAnimationFrame(gameLoop);
  }

  // Ba≈ülangƒ±√ßta oyun d√∂ng√ºs√ºn√º ba≈ülat
  gameLoop();

  // Oyun i√ßi dokunma / tƒ±klama olaylarƒ±
  canvas.addEventListener('click', (e) => {
    if (gameState !== 'playing') return;

    const rect = canvas.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const clickY = e.clientY - rect.top;

    // Eƒüer muz yenmemi≈üse, tƒ±klama muz yeme animasyonunu ba≈ülatƒ±r
    if (!banana.eaten && !eatAnimPlaying) {
      if (
        clickX >= banana.x && clickX <= banana.x + banana.w &&
        clickY >= banana.y && clickY <= banana.y + banana.h
      ) {
        eatAnimPlaying = true;
        return;
      }
    }

    // Eƒüer muz yendiyse
    if (banana.eaten && !eatAnimPlaying) {
      // Adamƒ±n √ºst√ºne tƒ±klandƒ±ysa iyi son
      if (
        clickX >= player.x && clickX <= player.x + player.w &&
        clickY >= player.y && clickY <= player.y + player.h
      ) {
        gameState = 'goodEnd';
        showOverlay();
      } else {
        // Yere tƒ±klanƒ±rsa k√∂t√º son
        gameState = 'badEnd';
        showOverlay();
      }
    }
  });

  function showOverlay() {
    endingText.textContent = gameState === 'goodEnd' ? "ƒ∞Yƒ∞ SON" : "K√ñT√ú SON";
    overlay.classList.remove('hidden');
  }

  replayBtn.addEventListener('click', () => {
    // Oyunu sƒ±fƒ±rla
    gameState = 'playing';
    banana.eaten = false;
    banana.w = 20;
    banana.h = 30;
    banana.x = player.x + 20;
    banana.y = player.y + 40;
    eatAnimPlaying = false;
    eatAnimFrame = 0;
    eatSoundPlayed = false;
    fartSoundPlayed = false;
    fartEffect.active = false;
    overlay.classList.add('hidden');
  });
</script>

</body>
</html>
