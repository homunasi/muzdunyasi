<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Muz D√ºnyasƒ± üçå</title>
<style>
  body {
    margin: 0; 
    background: #000;
    font-family: 'Press Start 2P', monospace;
    overflow: hidden;
    touch-action: manipulation;
    user-select: none;
  }
  canvas {
    display: block;
    margin: auto;
    background: #1a1a1a;
    image-rendering: pixelated;
  }
  #overlay {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: rgba(0,0,0,0.7);
    color: white;
    font-family: 'Press Start 2P', cursive;
    font-size: 14px;
    text-align: center;
    user-select: none;
  }
  #endingText {
    margin-bottom: 20px;
    font-size: 18px;
    text-shadow: 1px 1px 2px #000;
  }
  #replayBtn {
    cursor: pointer;
    background: #fff;
    color: #000;
    border: none;
    padding: 10px 25px;
    font-family: 'Press Start 2P', monospace;
    font-size: 12px;
    user-select: none;
  }
</style>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
</head>
<body>

<canvas id="gameCanvas" width="400" height="600"></canvas>

<div id="overlay">
  <div id="endingText">ƒ∞Yƒ∞ SON</div>
  <button id="replayBtn">TEKRAR OYNA</button>
</div>

<!-- Minecraft yeme sesi -->
<audio id="eatSound" src="https://actions.google.com/sounds/v1/foods/crunchy_bite.wav" preload="auto"></audio>
<!-- Osuruk sesi -->
<audio id="fartSound" src="https://www.soundjay.com/human/fart-01.mp3" preload="auto"></audio>

<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const overlay = document.getElementById('overlay');
  const endingText = document.getElementById('endingText');
  const replayBtn = document.getElementById('replayBtn');
  const eatSound = document.getElementById('eatSound');
  const fartSound = document.getElementById('fartSound');

  // Piksel adam √∂zellikleri
  const character = {
    x: 170,
    y: 280,
    width: 60,
    height: 80,
    hairColor: '#FFD700', // sarƒ± sa√ß
    pantColor: '#8B4513', // kahverengi pantolon
    shirtColor: '#000000', // siyah ti≈ü√∂rt
  };

  let state = 'intro'; // intro, farting, good, bad
  let fartAnimFrame = 0;
  let fartEmitted = false;
  let fartParticles = [];
  let bananas = [];

  // √áizim yardƒ±mcƒ± fonksiyonu (piksel blok)
  function drawPixelRect(x,y,w,h,color){
    ctx.fillStyle = color;
    ctx.fillRect(x,y,w,h);
  }

  // Adam √ßizimi
  function drawCharacter(){
    // kafa
    drawPixelRect(character.x + 18, character.y, 24, 24, '#fcd7a1'); // ten rengi kafa
    // sa√ß
    drawPixelRect(character.x + 20, character.y - 8, 20, 8, character.hairColor);
    // g√∂vde (ti≈ü√∂rt)
    drawPixelRect(character.x + 10, character.y + 24, 40, 40, character.shirtColor);
    // pantolon
    drawPixelRect(character.x + 10, character.y + 64, 40, 16, character.pantColor);
    // ayakkabƒ±
    drawPixelRect(character.x + 12, character.y + 80, 16, 8, '#322f2f');
    drawPixelRect(character.x + 32, character.y + 80, 16, 8, '#322f2f');
    // muz (ellerinde)
    drawPixelRect(character.x + 35, character.y + 40, 10, 20, '#ffeb3b');
    drawPixelRect(character.x + 40, character.y + 50, 5, 8, '#c7a800');
  }

  // Pƒ±rt partik√ºlleri √ßizimi ve g√ºncelleme
  function drawFartParticles(){
    fartParticles.forEach(p => {
      ctx.fillStyle = `rgba(200, 200, 200, ${p.alpha})`;
      ctx.beginPath();
      ctx.ellipse(p.x, p.y, p.size*2, p.size, 0, 0, Math.PI * 2);
      ctx.fill();
      p.x += p.vx;
      p.y -= 0.3;
      p.alpha -= 0.02;
    });
    fartParticles = fartParticles.filter(p => p.alpha > 0);
  }

  function emitFart(){
    for(let i=0; i<6; i++){
      fartParticles.push({
        x: character.x + 30 + Math.random() * 10,
        y: character.y + 80,
        size: 3 + Math.random()*2,
        alpha: 1,
        vx: (Math.random() - 0.5) * 1.5
      });
    }
    fartSound.play();
  }

  // Muz yaƒüƒ±≈üƒ± (k√∂t√º son)
  function drawBananas(){
    bananas.forEach(b => {
      drawPixelRect(b.x, b.y, 8, 16, '#ffeb3b');
      drawPixelRect(b.x + 4, b.y + 5, 4, 6, '#c7a800');
      b.y += 4;
    });
    bananas = bananas.filter(b => b.y < canvas.height + 20);
  }

  // Arka planlar

  function drawGoodBackground(){
    ctx.fillStyle = '#003300';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    for(let i=0; i<20; i++){
      for(let j=0; j<15; j++){
        ctx.fillStyle = (i+j) % 2 === 0 ? '#2e8b57' : '#3cb371';
        ctx.fillRect(i*20, j*20, 20, 20);
      }
    }
  }
  function drawBadBackground(){
    ctx.fillStyle = '#442200';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    for(let i=0; i<20; i++){
      for(let j=0; j<15; j++){
        ctx.fillStyle = (i+j) % 2 === 0 ? '#ffeb3b' : '#ffc107';
        ctx.fillRect(i*20, j*20, 20, 20);
      }
    }
  }

  // Oyun sahnesi √ßizimi
  function drawScene(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    if(state === 'intro'){
      // G√∂ky√ºz√º ve √ßimen
      ctx.fillStyle = '#87ceeb';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#228B22';
      ctx.fillRect(0, character.y + character.height, canvas.width, canvas.height - (character.y + character.height));
      // G√ºne≈ü
      ctx.fillStyle = '#FFD700';
      ctx.fillRect(320, 30, 40, 40);

      drawCharacter();
    }
    else if(state === 'farting'){
      drawCharacter();
      drawFartParticles();
    }
    else if(state === 'good'){
      drawGoodBackground();
      drawCharacter();
    }
    else if(state === 'bad'){
      drawBadBackground();
      drawBananas();
    }
  }

  // Animasyon ve zamanlama i√ßin
  let eatPlayed = false;
  let fartStartTime = 0;

  function gameLoop(timestamp){
    drawScene();

    if(state === 'intro' && !eatPlayed){
      eatSound.play();
      eatPlayed = true;
      // 1.5 saniye sonra osuruk animasyonu ba≈ülasƒ±n
      setTimeout(() => {
        state = 'farting';
        fartStartTime = performance.now();
        fartSound.play();
        // Pƒ±rt partik√ºllerini ba≈ülat
        emitFart();
      }, 1500);
    }

    if(state === 'farting'){
      // 2 saniye sonra iyi son ekranƒ±na ge√ß
      if(performance.now() - fartStartTime > 2000){
        showEnding('ƒ∞Yƒ∞ SON');
        state = 'good'; 
      }
      drawFartParticles();
    }

    requestAnimationFrame(gameLoop);
  }

  // Tƒ±klama i≈ülemleri
  canvas.addEventListener('click', e => {
    if(state !== 'intro' && state !== 'good') return;

    const rect = canvas.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const clickY = e.clientY - rect.top;

    if(state === 'intro'){
      // ƒ∞yi son i√ßin adamƒ±n √ºst√ºne tƒ±klanmasƒ± gerekiyor (ama adam zaten osurduktan sonra iyi son oluyor)
      // Burada adam tƒ±klanƒ±rsa iyi son deƒüil ama biz senin dediƒüine g√∂re iyi son osuruktan sonra ekranƒ± √ßƒ±kacak
      // O y√ºzden introda adam tƒ±klanƒ±rsa ge√ßi≈ü yok

      // Yere tƒ±klanƒ±rsa k√∂t√º sona ge√ß
      const onCharacter = (
        clickX >= character.x && 
        clickX <= character.x + character.width &&
        clickY >= character.y &&
        clickY <= character.y + character.height
      );
      if(!onCharacter){
        // K√∂t√º son
        state = 'bad';
        // Muz yaƒüdƒ±r
        for(let i=0; i<60; i++){
          bananas.push({
            x: Math.random() * canvas.width,
            y: -Math.random() * 600
          });
        }
        showEnding('K√ñT√ú SON');
      }
    } else if(state === 'good'){
      // ƒ∞yi son ekranda tekrar oyna i√ßin tƒ±klama
      // Burasƒ± overlay'deki butonla hallediliyor zaten
    }
  });

  // Son ekran g√∂sterimi
  function showEnding(text){
    endingText.textContent = text;
    overlay.style.display = 'flex';
  }

  // Tekrar oyna butonu
  replayBtn.addEventListener('click', () => {
    overlay.style.display = 'none';
    state = 'intro';
    eatPlayed = false;
    fartParticles = [];
    bananas = [];
  });

  // Oyun ba≈ülat
  requestAnimationFrame(gameLoop);
</script>

</body>
</html>
